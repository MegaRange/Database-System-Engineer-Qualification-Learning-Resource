[<<主目录](https://www.unitalk.fun/unitalk/public/d/55-python)

[何不学Python：三、变量常量及编程的三大结构](https://www.unitalk.fun/unitalk/public/d/70-python)
在上一章中，我们浅要介绍了变量，编程中的三大基本结构之一的顺序结构。
在本章中将认识能够帮助你多次进行**一系列操作**的——函数。
有了函数，我们可以将一些操作“封装”起来，并在需要的时候随时随地地，调用一次或多次，从而减少你需要写的重复的代码。

本章推荐使用VSCode等IDE来学习。

___
### 我们熟悉的函数
我们说到了顺序结构，接下来我们说一说函数。毕竟，函数是顺序结构的最佳代表。
我们之前已经接触过一些函数了。包括Python自带的函数，和math模块中的函数。

如果你还记得第一章的内容，就能想到，`print()`是我们调用的第一个函数。
虽然不是经典的Hello World程序，我们还是把它复制过来。
```Python
print("啊啊啊啊啊啊啊")
```
请看那一串“啊”组成的字符串。这个字符串，我们称之为提供给函数用作计算的“参数”。就好比`print()`这个例子，你为它提供一个参数，它将你的参数打印到屏幕上。
函数要求的参数的类型和数量是在定义函数的时候规定的。如果你想定义一个不需要任何参数的函数，或者没有返回值的函数，也是可以的。这样的函数在之前称作“过程”。

之前说过，你可以先用数学的方式理解编程中的函数。我们先从一个简单的二元函数来了解并定义一个Python的函数。
[center]![函数1](https://raw.githubusercontent.com/MegaRange/Learning-Resource/master/%E4%BD%95%E4%B8%8D%E5%AD%A6Python/Images/%E5%87%BD%E6%95%B01.svg)[/center]
我们现在有自变量`x`和`y`。在编程中，这些自变量成为了函数的参数。
我们很容易就能用语言描述出这个函数的功能。至少从数学角度上可以：

> 数学：给定自变量`x`与自变量`y`，求`x + y`的值。
> 编程：给定参数`x`与参数`y`，返回`x + y`的值。

接下来我们将在Python中定义这个函数。

___
### 你的第一个函数
为了便于理解，我们来分步骤讲解函数的定义方法。
Python中，使用`def`关键字来定义一个函数。

💬**最基本的函数结构：**
```Python
def 函数名称(参数们):
    代码
    代码
    return 返回值
```

首先我们决定这个函数的名字，从函数的功能来看，我们最好叫它`add`。

然后就是让你的`add()`函数接受两个参数，我们称这两个参数为“**形式参数**”，或者简称“**形参**”。形参作为函数中参与计算的传入参数的符号，也需要名字。我们根据之前的设想来叫作`x`和`y`，写成`add(x, y)`。
形参就像数学函数中的xyz一样，是自变量的代表。

最后是一个很重要的冒号`:`，就像是函数将要说出它要做的操作一样。
连起来，下面就是定义的全貌：
```Python
def add(x, y):
```

然后换一行，打上四个空格先。下面介绍“代码块”时会告诉你为什么必须这么做。
这样就进入到了函数的主体，也就是“函数体”。即本例中实现x+y的代码。
我们先引入一个“**中间变量**”`result`来保存x+y的值。
```Python
def add(x, y):
    result = x + y
```

最后，我们需要返回这个结果。另起一行，四个空格。使用`return`关键字来告诉程序在这里返回一些值，并结束函数运行。
然后这个函数就完成了。成品函数：
```Python
def add(x, y):
    result = x + y
    return result
```
至此我们就实现了f(x,y)=x+y这个函数。

这么简单的例子，我们可以使用更好的写法，不要`result`这个中间变量了，直接返回x+y。
```Python
def add(x, y):
    return x + y
```

我们就可以在后面的程序中，调用这个函数了。
```Python
print(add(3, 4))
print(add("Hello", "World"))
```
我们给函数传递的，用来参与计算的`3`和`4`，就是“**实体参数**”，我们经常用简称“**实参**”称呼。
实参就像我们在数学中代入进函数的数字一样。

这个例子的另一个特点就是它是个“套娃”，行话叫“函数嵌套”。是将`add()`的计算结果放进`print()`中打印。
编程里允许套娃，只要你不搞乱你的逻辑就行。

___
### “代码块”与所谓“缩进”很重要
在你初步理解了函数之后，我们来看看刚才提到的，很重要的，也是我肥肠反感的代码块方式——Python的**[color=red]缩进[/color]**。
所谓**代码块**，即是“一块代码”~（这不废话吗）~。我们会在定义函数和之后要讲的分支、循环语句中，以及类中使用代码块。它的概念就是，当执行函数或分支循环的“里面”的程序时，将执行属于它的这一“块”代码。
Python定义函数和循环分支时使用的冒号`:`用来“开始”代码块。即：下面这一块代码属于这个分支或者循环语句。
一般情况下，一块代码属于它上面那条“`:`”它的语句。
就像引用说话的排版一样：
```markdown
Qitu wrote:
    欧拉欧拉欧拉欧拉欧拉欧拉欧拉欧拉欧拉
    欧拉欧拉欧拉
```

代码块也有“套娃”的概念，即，代码块里面有代码块，这种行为我们叫“嵌套”。“嵌套”的每个“层级”，在Python中，以一定数量的空格缩进来区分。Python推荐**每个层级使用4个空格**的缩进方法。
注：你也可以使用`Tab`键缩进。

💬暂且借用下一章的知识，用一段有两个层级的伪代码（概念代码）来演示：
```Python
def 子程序():
    一些代码                # 四个空格，第一层，这些代码属于子程序
    if(条件):               # 这个if也属于子程序
        一些代码            # 八个空格，第二层，属于这个if
        另一些代码
    else:
        其他的代码          # 属于else
```
💬对C语言稍微有了解同学的可以跟下面的伪代码做个对比：
```C
void 子程序(){
    一些代码;               // 第一层花括号，属于子程序
    if(条件){               // 这个if也属于子程序
        一些代码;           // 第二层花括号，属于if
        另一些代码;
    }
    else
        其他的代码;         // 属于else
}
```

所以你现在在第几层？

___
### 变量的作用域
我们了解了代码块的概念，接下来不得不跟你讲一讲，“作用域”是啥玩意儿。
作用域用人话讲就是你定义的变量能在哪些区域使用。

Python定义变量的方式不像C语言那样需要做一次声明。只要你给一个变量**首次赋了值**，那你就算是**声明**或者说**定义**它了。
扩大一点说，由于几乎任何东西在Python这里都按对象一般同等对待，与其说这个知识点是“变量的作用域”，倒不如说它是“**对象的作用域**”。

所以我们按照对象来讲。Python中对象的可用性是非常直观的，请看以下两个特点：
1. 你在程序中声明的对象，可以在它声明之处**下面的任何地方**使用。
2. 但你在你定义的函数，或者后面会讲到的类中，声明了一些对象，那它们**只能**在它们所在的函数定义和类定义中使用。

这么多话往往不如一个图例：
![作用域图解](https://raw.githubusercontent.com/MegaRange/Learning-Resource/master/%E4%BD%95%E4%B8%8D%E5%AD%A6Python/Images/%E4%BD%9C%E7%94%A8%E5%9F%9F1.png)

在图中，注释掉的两行，是会引发错误的代码。因为那两行代码所访问的对象，不在其作用域中，并不能访问。

之后讲到分支结构和循环结构时，会为你进一步介绍，在这两个结构中声明的变量的作用域。

___
### 函数参数有微操
下面的知识点虽然有点啰嗦，但我觉得还是应该讲出来。
在定义函数的时候，你可以为函数指定一些“微操”（定制）。使用这些功能可以让你的函数参数的传入更加灵活或严格。

首先，在大多数编程语言中，参数的长度可以有两种形态：**定长参数**和**变长参数**。
在本章中，将为你介绍定长参数的定制。

我们先做一个，有五个形式参数的函数：
```Python
def f(a, b, c, d, e):
    print(a, b, c, d, e)
```
这样就会让它打印出这五个参数了。

我们先来介绍一下，Python中传入参数的两种方式。
我们以最常用的方法传入的参数叫做“**指定位置参数**”，它们的位置是固定的，是你在定义函数时已经安排好的位置。
```Python
f(10, 20, 30, 40, 50)
```
你还可以以“**关键字参数**”（也就是使用形参的名字）方式传入参数：
```Python
f(10, 20, c = 30, d = 40, e = 50)
```
本例中`c`，`d`，`e`就是关键字参数，非常直观是不是？
使用关键字参数时，还可以打乱它们的顺序：
```Python
f(30, e = 40, c = 20, b = 15, d = 35)
```
[color=yellow]**⚠注意：**[/color]别顺便把你脑子打乱了。
[color=red]**❌请留意错误：**[/color]你**必须**在**所有**指定位置参数的**后面**使用关键字参数，否则将产生语法错误（`SyntaxError`）。另外，如果你打乱顺序，请注意**不要**重复传入参数，否则将引发名为重复参数传入的类型错误（`TypeError`）。
多说不如示例，请看错误的例子：
```Python
f(10, 20, c = 30, 40, 50)   #❌语法错误：指定位置参数在关键字参数之后。
f(10, 20, 30, 40, c = 50)   #❌类型错误：f传入了多个参数`c`的值。
                            #   因为指定位置参数已经为`c`传入了值。
```
不过，重复参数传入为啥是类型错误捏！？

接下来我们介绍在定义函数时如何为你的参数做一些“规定”。

首先，你可以使用赋值运算符`=`来为形参指定默认值。
```Python
def f(a, b, c, d = 24, e = "abcdefg"):
    print(a, b, c, d, e)
```
这样`d`和`e`就有了默认值，如果你不传入，它们将使用默认值参与计算。
就像这样：
```Python
f(27, 54, 108, 'abc')   # 未向形参e传入参数，它将使用默认值。
```
[color=yellow]**⚠注意：**[/color]类似上面的错误示例，你**必须**在**所有**无默认值参数的**后面**定义有默认值参数。

除此之外，你可以使用星号`*`和斜线`/`来为你参数规定传入方式。
它们在这里不是乘号或者除号了啊记住。

先讲斜线`/`，将它当成一个参数放在形参的定义中，可以使它**前面**的所有形参**必须使用**指定位置参数形式传入。
比如你这样定义：
```Python
def f(a, b, /, c, d, e):
    print(a, b, c, d, e)
```
那么，它的`a`与`b`，你就**必须**用指定位置参数的形式传入了。

然后是星号`*`，将它当成一个参数放在形参定义中的话，可以将它**后面**的所有形参**必须使用**关键字参数形式传入。
比如：
比如你这样定义：
```Python
def f(a, b, c, *, d, e):
    print(a, b, c, d, e)
```
它的`d`，`e`就**必须**使用关键字的形式传入了。
[color=red]**❌请留意：**[/color]这两种特殊规定的参数，如果你执意要用不同的形式传入，那就一定会引发错误。

在定义时，你可以同时使用`*`和`/`来达到为参数制定规则的效果，但请记住，`*`必须在`/`**之后**。

变长参数涉及到之后的内容，我们将在讲循环结构之后讲解。

___
### 匿名函数
匿名函数在一些编程语言中，是一个用来实现一个逻辑炒鸡简单的函数的功能，它能且只能用一行表示。
使用`lambda`~（“λ”！！）~关键字来定义匿名函数。你需要将匿名函数的主体看作一个表达式，并“赋值”给一个你用来调用它的名字。

💬**匿名函数体的结构：**
```Python
lambda 形式参数们 : 结果计算表达式
```

我们来把之前我们`add()`函数的例子用匿名函数实现：
```Python
add = lambda x, y: x + y
```
然后我们就可以像调用函数一样调用匿名函数了。
```Python
print(add(3, 4))
print(add("Hello", "World"))
```

使用匿名函数的好处就是节省代码。如果你要做一个明知道会多次调用的，而且还很小的操作，那么请一定考虑使用匿名函数。

匿名函数之所以匿名是因为它的函数体没有命名，不像`def`那样由你来先给它命名了。然而这名字取的其实不咋地，毕竟并不是真的“匿名”，真匿名了咱上哪调用啊，是吧，再说能用名字还从内存直接call那不是有毛病且一点不Python吗。但咱也说了不算，你要把这话讲出来，会有一大堆人跟你讲编程大道理的……

___
在下一章中，将为你介绍编程中的分支结构。
[何不学Python：五、编程基本结构之分支结构](https://www.unitalk.fun/unitalk/public/d/108-python)